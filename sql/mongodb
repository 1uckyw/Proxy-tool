
import pymongo

from sql.sql_base import SqlBase
from proxy import Proxy

class Mongodb(SqlBase):

    def __init__(self, **kwargs):
        super(Mongodb, self).__init__(**kwargs)
        self.client = pymongo.MongoClient(**kwargs)
        self.db = self.client[config.database]

    def init_database(self, database_name):
        pass
    def init_proxy_table(self, table_name):
        pass
    def insert_proxy(self, table_name, proxy):
        data = proxy.get_dict()
        data['save_time'] = str(datetime.datetime.now())
        self.db[table_name].insert(data)
